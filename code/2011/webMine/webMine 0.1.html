<html>
<head><title>Javascript扫雷</title>
<style type="text/css" rel="stylesheet">
td.out{
	background:#8ABDEF;
}
td.over{
	background:#8EDDFF;
}
td.clicked{
	background:#D1DEEE;
}
tr, td{
	padding:0px;
	margin:0px;
}
td{
/*	font-size:12px;	*/
	width:35px;
	height:35px;
	text-align:center;
}
</style>
</head>
<script type="text/javascript">
function setBgcolor(td){
	if(td.className == "out"){
		td.className = "over";
	}else if(td.className == "over"){
		td.className = "out";
	}
}

function showNumber(td){
//	td.innerHTML = getNodeIndex(td.parentNode) + "," + getNodeIndex(td);
//	td.innerHTML = setMine(9,9,10);
	td.innerHTML = exploreMine(td);
//	td.innerHTML = (exploreMine(td))?"":"";
}

/*function tdPosition(td){
	var tr = td.parentNode;
	var trIndex = 0;
	var tdIndex = 0;
}*/

function getNodeIndex(node){
	if(node == null){
		return null;
	}

	var index = 0;
	var type = node.nodeName;
	
	while(node.previousSibling != null){
		if(node.previousSibling.nodeName == type){
			index++;
		}
		node = node.previousSibling;
	}
	return index;
}

function setMine(width, height, number){
	var mine_position = new Array(number);
	var x, y;
	for(var i=0; i<number; i++){
		x = Math.floor(Math.random()*width);
		y = Math.floor(Math.random()*height);
		mine_position[i] = [x, y];
		if(newMemberInArray(mine_position[i], mine_position)){
			//alert(mine_position[i]+"\n"+mine_position);
			continue;
		}
		mine_position.pop();
		i--;
	}
	return mine_position;
	
/*	var gross = width*height;
	var numberArray = new Array(number);
	for(var i=0; i<number; i++){
		numberArray[i] = Math.floor(Math.random()*gross);
	}
	return numberArray;
*/
	
//	return width*height;
//	return Math.floor(Math.random()*number);
}

function exploreMine(td){
//	getNodeIndex(td.parentNode) + "," + getNodeIndex(td);
//	minePosition;
	var x = getNodeIndex(td.parentNode);
	var y = getNodeIndex(td);
	
	for(var i=0; i<minePosition.length; i++){
		if((x == minePosition[i][0]) && (y == minePosition[i][1])){			//	if([x, y] == mine_position[i]){		//	wrong!
			return true;
		}
	}
	return false;
}

function newMemberInArray(value, array){		//	此方法对一维数组有效，对二维数组失效。。。解决方法：将数组转换成字符串进行比较（用字符串方法或自定义正则）
	var count = 0;
/*	
	for(var i in array){
		if(value == array[i]){
			count++;
		}
	}
*/
//	alert("value: "+value+"\ncount: "+count + "\narray:   " + array + "  \narray.length     " +array.length);


	for(var i=0; i<array.length-1; i++){
		if(value == array[i]){
			count++;
		}
	}
	return (count==0)?true:false;
//	return count;
}
</script>

<body bgcolor="#DCDCDC">
<!-- <body bgcolor="gainsboro"> -->


<script type="text/javascript">
document.write("<table border=\"1\" align=\"center\" cellspacing=\"0\" bgcolor=\"white\">");
	for(var i=0; i<9; i++){
		document.write("<tr>");
		for(var j=0; j<9; j++){
			document.write("<td class=\"out\" onmouseover=\"setBgcolor(this)\" onmouseout=\"setBgcolor(this)\" onclick=\"showNumber(this);this.className='clicked'\"></td>");
		}
		document.write("</tr>");
	}
document.write("</table>");
var minePosition = setMine(2,2,2);


/**/
var arr = [];
arr[0] = [2,3];
arr[1] = [3,3];
arr[2] = [2,4];
arr[3] = [3,3];
arr[4] = [3,3];
var ss = [];
ss[0] = [2,4];
//alert(newMemberInArray(ss[0],arr));
//alert(newMemberInArray(arr[2],arr));
//alert(ss[0] + "\n" + arr[2] + "\n" + (ss[0] + "\n" + arr[2]));
alert(arr[4] + "  " + newMemberInArray(arr[4],arr) + "in\n" + arr);
alert(arr[1] + "  " + newMemberInArray(arr[1],arr) + "in\n" + arr);
alert(arr[0] + "  " + newMemberInArray(arr[0],arr) + "in\n" + arr);

//var arrs = [1,4,76,1,1,4];
//alert(newMemberInArray(7,arrs));
</script>




</body>
</html>